**Q1**: Where are these hundreds of functions?

**Answer**: In the libraries that we include.

**Q2**: Explore the program. What does it do? Where is the vulnerability?

**Answer**:

It asks user input for an unsinged integer (corresponding to the index of the airline company) and then for the user's name (array of char). Then it checks if the chosen airline is within the lists of *bookings*.

I have disabled ASLR so the addresses are not randomized, which means a quick inspection of the binary generated by running `make ex1` can give me details about the addresses of functions, variables and where are the sections of the binary located in the memory.

Since the user is prompted for input, we can use the buffer overflow attack.

**Q3**: How does ret2libc fit into this? What are some nice libc functions for exploitation?

**Answer**:

 Since there is no interesting function written by the programmer here that we can call to get a shell, we can use a function from the `libc` library to get a shell. Some nice libc functions that I can think of are `execve` (that we used in the last lab) and `system`.

**Q4**: Can we get a shell with this program? How?

**Answer**:

We can use the buffer overflow exploit and overwrite the return adress with the address of the `system` function from the `libc` library.

The address of the `system` function: `0x7ffff7c4b980` from:

```bash
pwndbg> info address system
Symbol "system" is at 0x7ffff7c4b980 in a file compiled without debugging.
```

The address of the `name` variable is `0x7fffffffd410`:

```bash
pwndbg> p &name
$1 = (char (*)[64]) 0x7fffffffd410
```

The start of the `check_booking` function is

pwndbg> p (long)($rbp+8) - (long)(&name)
$5 = 344

